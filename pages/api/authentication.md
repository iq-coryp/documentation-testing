---
title:  Authentication
permalink: /api/authentication/
tags: []
keywords: 
audience: 
last_updated: 30-11-2015
summary: 
---
{% include linkrefs.html %}

## Overview

iQmetrix APIs are protected by {{OAuth2_Glossary}}.

In order to make authorized requests to iQmetrix APIs, your application must first obtain an {{AccessToken_Glossary}}.

## Note

The code samples below use the following `OAuth2TokenResponse` object,

```csharp
public class OAuth2TokenResponse
{
    public string access_token { get; set; }
    public string expires_in { get; set; }
    public string refresh_token { get; set; }
}
```      


## Endpoints

* Sandbox: <a href="https://accountsdemo.iqmetrix.net/v1">https://accountsdemo.iqmetrix.net/v1</a>
* Production: <a href="https://accounts.iqmetrix.net/v1">https://accounts.iqmetrix.net/v1</a>

## Resources





## Obtaining an Access Token

{{note}}
Each time this request is made, a <b>new</b> access token is created and returned
{{end}}

{{tip}}
As long as an access token is not expired, it can be used to authorize requests to <b>ANY</b> iQmetrix API. 
{{end}}

### Refreshing an Access Token

Instead of always using credentials, a client application may use the refresh token to obtain a new access token.

{{important}}
Once a refresh token has been exchanged, the access token it was provided with is revoked
{{end}}
{{note}}
The client credentials must be the same as those used in the request to acquire the provided refresh token
{{end}}   

###### Code Sample (C#)

```c#
using RestSharp;
using RestSharp.Contrib;

public static OAuth2TokenResponse ObtainingAnAccessToken()
{
    var client = new RestClient("https://accountsdemo.iqmetrix.net/v1/oauth2");
    var request =
        new RestRequest("token", Method.POST)
            .AddParameter("grant_type", "password")
            .AddParameter("username", "email@example.com")
            .AddParameter("password", "examplepassword")
            .AddParameter("client_id", "exampleclient")
            .AddParameter("client_secret", "examplesecret");

    request.AddHeader("Content-Type", "application/x-www-form-urlencoded");

    var response = client.Execute<OAuth2TokenResponse>(request);

    return response.Data;
}
```


#### Request

    POST /oauth2/token

#### Headers


* `Content-Type: application/x-www-form-urlencoded`





#### Request Parameters

* `grant_type` (**Required**) - The value must be `password`
* `username` (Optional) - The username provided to iQmetrix, usually an email address. Required for acquiring an access token
* `password` (Optional) - The password, provided when an account is created. Required for acquiring an access token
* `client_id` (**Required**) - The client ID, provided by iQmetrix
* `client_secret` (**Required**) - The client secret
* `refresh_token` (Optional) - The refresh token to be exchanged, required for refreshing a token


###### Example

```
POST /oauth2/token
Content-Type: application/x-www-form-urlencoded


```

#### Response


  * `access_token` (string) - The access token issued by the authorization server
  * `expires_in` (integer) - Seconds remaining until the access token expires, **12 hours** or less if revoked
  * `refresh_token` (string) - The refresh token generated by the authorization server, expires after **7 days**


###### Example

```
HTTP 200 Content-Type: application/json
{
"access_token": "3dae10c05e894011b5b3ae15972ffbf4",
"expires_in": 43199,
"refresh_token": "f8bk56n40f7gi34j49g7bh4n430gf874h"
}```

## Errors

| HTTP Status Code | Description | How to Resolve |
|:-----------------|:------------|:---------------|
| `HTTP 400` | `unsupported_grant_type` | Ensure grant_type is set to appropriately |
| `HTTP 400` | `invalid_client` | Ensure client_id and client_secret are correct |
| `HTTP 400` | `invalid_grant` | Ensure client credentials are correct. For a refresh token, ensure credentials are the same as those used to acquire the original access token  |
